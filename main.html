<!doctype html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1">
<title>Pflegegeldrechner</title>

<style>
html, body {
  margin: 0;
}
.pgr_container {
  font-family: sans-serif;
  color: #222;
  background: white;
  border: 1px solid #aaa;
  border-width: 1px 0;
  padding: 4% 5%;
}
.pgr_container h2 {
  font-weight: normal;
  color: #cb0054;
}
.pgr_container h2 strong {
  font-weight: bold;
  color: #222;
}
.pgr_container h2 strong:after {
  content: ".";
  color: #cb0054;
  font-weight: normal;
  margin: 0 -2px;
}
.pgr_container,
.pgr_container header,
.pgr_container footer,
.pgr_container output {
  display: block;
}
.pgr_container input,
.pgr_container button {
  font-family: sans-serif;
  color: #222;
  font-size: 100%;
  margin: 0;
  vertical-align: baseline;
  *vertical-align: middle;
  line-height: normal;
}
.pgr_container form {
  margin: 0;
}
.pgr_container .active output,
.pgr_container output:focus {
  -webkit-border-radius: 0.5em;
     -moz-border-radius: 0.5em;
      -ms-border-radius: 0.5em;
          border-radius: 0.5em;
  padding: 3%;
  margin-bottom: 1em;
}
.pgr_container output:focus {
  outline: 0;
  background: white;
}
.pgr_container button {
  cursor: pointer;
  -webkit-appearance: button;
  *overflow: visible;
  padding: 0.5em 1em;
  border: 1px solid #333;
  background: whiteSmoke;
  -webkit-border-radius: 0.5em;
     -moz-border-radius: 0.5em;
      -ms-border-radius: 0.5em;
          border-radius: 0.5em;
}
.pgr_container input[type="radio"] {
  box-sizing: border-box;
  padding: 0;
  *width: 13px;
  *height: 13px;
}
.pgr_container label {
  cursor: pointer;
}
.pgr_container ul {
  border: 0;
  margin: 0;
  padding: 0;
  list-style: none;
}
.pgr_container li {
  padding-bottom: 7px;
  margin-bottom: 7px;
  border-bottom: 1px solid #ccc;
}
.pgr_container li:last-child {
  padding-bottom: 0;
  margin-bottom: 0;
  border-bottom: 0;
}
.pgr_container legend {
  border: 0;
  padding: 0 0.3em;
  margin-left: 0.5em;
  white-space: normal;
  *margin-left: -7px;
}
.pgr_container fieldset {
  border: 0;
  margin: 0;
  padding: 1em 0;
  border-top: 1px solid #333;
}
/* .pgr_container fieldset.pgr_pflegestufe label {
  display: inline-block;
  width: 27%;
  margin: 0;
  padding: 3%;
  background: white;
  -webkit-border-radius: 0.5em;
     -moz-border-radius: 0.5em;
      -ms-border-radius: 0.5em;
          border-radius: 0.5em;
} */
.pgr_container fieldset.pgr_pflegestufe label {
  display: block;
  margin: 0 0 1em 0;
  padding: 3%;
  background: whiteSmoke;
  font-weight: bold;
  -webkit-border-radius: 0.5em;
     -moz-border-radius: 0.5em;
      -ms-border-radius: 0.5em;
          border-radius: 0.5em;
}
.pgr_container fieldset.pgr_pflegestufe label:hover {
  background: #eee;
}
.pgr_container fieldset.pgr_pflegestufe label small {
  display: inline-block; *display: inline; *zoom: 1;
  font-size: 100%;
  font-weight: normal;
  margin-left: 0.5em;
}
.pgr_container fieldset.pgr_pflegestufe input {
  margin-right: 0.3em;
}
.pgr_container input[name="pgr_sachleistung"] {
  width: 5em;
  text-align: right;
  border: 1px solid #222;
  background: whiteSmoke;
  border: 3px solid white;
  border-bottom: 1px dotted grey;
  padding: 0.4em 0.7em;
  margin: 0.5em 0.4em 0 0;
  color: black;
  -webkit-border-radius: 0.5em;
     -moz-border-radius: 0.5em;
      -ms-border-radius: 0.5em;
          border-radius: 0.5em;
}
.pgr_container input[name="pgr_sachleistung"]:focus {
  outline: 0;
}
.pgr_container input[name="pgr_sachleistung"]:invalid {
  background-color: #fdd;
  border-color: #fdd;
  border-bottom-color: red;
}
.pgr_container .pgr_information {
  padding-bottom: 1.2em;
}
.pgr_container .pgr_inactive {
  display: none;
}
.pgr_container .pgr_visuallyhidden {
    border: 0;
    clip: rect(0 0 0 0);
    height: 1px;
    margin: -1px;
    overflow: hidden;
    padding: 0;
    position: absolute;
    width: 1px;
}

</style>

<section class="pgr_container">
  <!--
  <header>
    <h2><strong>Pflegegeld</strong>rechner</h2>
    <p>von der Sozialstation - ambet e. V.</p>
  </header>
  <div class="pgr_information">
    <p>
      Je nach Pflegestufe und erbrachter Pflegesachleistung kann ein Anspruch auf Pflegegeld entstehen. Dieses Pflegegeld wird von der Pflegekasse ausgezahlt.</p>
    <p>
      <strong>Bitte informieren Sie sich in einem persönlichen Gespräch über die genauen Verfahrensweisen.</strong></p>
    <p>
      Vorab bieten wir Ihnen diesen Pflegegeldrechner, mit dem Sie ausrechnen können, wie viel Pflegegeld ausgezahlt würde, wenn Sie eine Pflegesachleistung von uns in Anspruch nehmen würden. Dieser Pflegegeldrechner ersetzt keine Beratung, wenden Sie sich daher bitte bei weitergehenden Fragen oder Unklarheiten an uns.</p>
  </div>
  -->
  <form method="post">
    <fieldset>
      <legend><b>1)</b> Pflegesachleistung</legend>
      <label>
        Die Sachleistung/Pflegekosten, die übernommen werden sollen:<br>
        <input type="number" min="0" step="1" name="pgr_sachleistung" placeholder="0" autofocus>
        <abbr title="in Euro">€</abbr>
      </label>
    </fieldset>
    <fieldset class="pgr_pflegestufe">
      <legend><b>2)</b> Pflegestufe</legend>
      <label>
        <input type="radio" name="pgr_pflegestufe" value="0" checked>
        Pflegestufe I
        <small>(Maximal 450&nbsp;€ Sachleistung und 235&nbsp;€ Pflegegeld)</small>
      </label>
      <label>
        <input type="radio" name="pgr_pflegestufe" value="1">
        Pflegestufe II
        <small>(Maximal 1100&nbsp;€ Sachleistung und 440&nbsp;€ Pflegegeld)</small>
      </label>
      <label>
        <input type="radio" name="pgr_pflegestufe" value="2">
        Pflegestufe III
        <small>(Maximal 1550&nbsp;€ Sachleistung und 700&nbsp;€ Pflegegeld)</small>
      </label>
    </fieldset>

    <fieldset class="pgr_result">
      <legend><b>3)</b> Ergebnis</legend>
      <output></output>
      <button type="submit">Berechnen</button>
    </fieldset>
  </form>
  <footer><small>Alle Angaben ohne Gewähr</small></footer>
</section>

<script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
<script>
  (function ($) {
    var container = $('section.pgr_container'),
      form = container.find('form'),
      output = container.find('output'),
      result = container.find('fieldset.pgr_result'),
      data = [[450, 235], [1100, 440], [1550, 700]],
      texts = {
        keineSachleistung: '<p>Bitte geben Sie unter <b>1)</b> die Höhe der ausgeschöpften Sachleistung ein!</p>',
        keinAnspruch: '<p><strong>Die zur verfügung stehende Pflegesachleistung wurde voll ausgeschöpft. Ein Anspruch auf anteiliges Pflegegeld besteht somit nicht.</strong></p>',
        result: '<p><strong>Ihr anteiliges Pflegegeld: $pflegegeld&nbsp;€</strong></p>' +
          '<ul><li>Nicht ausgeschöpfte Pflegesachleistung ist $diffPflegesachleistung&nbsp;€</li>' +
          '<li>Sie nutzen $anteil&nbsp;% der verfügbaren Sachleistung nicht.</li>' +
          '<li>Damit stehen ihnen $anteil&nbsp;% des Pflegegeldes zu.</li>' +
          '<li>Das maximal zustehende Pflegegeld ist $maxPflegegeld&nbsp;€.</li>' +
          '<li>Ihr anteiliges Pflegegeld ist $pflegegeld&nbsp;€.</li></ul>'
      };

    function calculate() {
      var result,
        // Ausgeschöpfte Pflegesachleistung
        pflegesachleistung = parseInt(
            container.find('input[name=pgr_sachleistung]').val(), 10),
        // Ausgewählte Pflegestufe
        pflegestufe = parseInt(
            container.find('input[name=pgr_pflegestufe]:checked').val(), 10),
        // Zustehende Pflegesachleistung
        maxPflegesachleistung = data[pflegestufe][0],
        // Zustehendes Pflegegeld
        maxPflegegeld = data[pflegestufe][1],
        // Nicht ausgeschöpfte Pflegesachleistung
        diffPflegesachleistung = maxPflegesachleistung - pflegesachleistung,
        // Anteil der Pflegesachleistung nicht ausgeschöpft
        anteil = diffPflegesachleistung / maxPflegesachleistung,
        // Zustegendes Pflegegeld,
        pflegegeld = anteil * maxPflegegeld;

      // Ausgabe in Prozent
      anteil = ('' + Math.round(anteil * 10000) / 100).replace('.', ',');
      // Ausgabe runden
      pflegegeld = ('' + Math.round(pflegegeld * 100) / 100).replace('.', ',');

      if (!pflegesachleistung || pflegesachleistung < 0) {
        return texts.keineSachleistung;
      }
      if (diffPflegesachleistung <= 0) {
        return texts.keinAnspruch;
      }

      return texts.result
        .replace(/\$pflegegeld/gi, pflegegeld)
        .replace(/\$anteil/gi, anteil)
        .replace(/\$maxPflegegeld/gi, maxPflegegeld)
        .replace(/\$diffPflegesachleistung/gi, diffPflegesachleistung);
    }

    form.on('submit', function (e) {
        e.preventDefault();
        e.stopPropagation();

        output
          .attr('tabindex', '-1')
          .html(calculate())
          .get(0).focus();
      });

    container.find('input').on('change keyup',
      function () {
        output.html(calculate());
      });
    container.find('button').addClass('pgr_visuallyhidden');
    container.find('.pgr_pflegestufe label').on('touch click',
      function () {
        $(this).find('input').checked('checked', true);
      });
    output.html(calculate());
  }(jQuery));

</script>
